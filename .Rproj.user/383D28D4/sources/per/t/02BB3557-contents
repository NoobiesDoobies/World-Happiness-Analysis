---
title: "Exploratory Data Analysis -"
author: "Carlios Eryan"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
# clear-up the environment
rm(list = ls())

# chunk options
knitr::opts_chunk$set(
  message = FALSE,
  warning = FALSE,
  fig.align = "center"
)

options(scipen = 999)
library(readr)
library(dplyr)
library(reshape)
library(ggplot2)
```

##1. Explanation

```{r}

```

#2. Read data and initial inspection

Read data using read.csv (data is in the same folder)

```{r}
cereal <- read.csv("cereal.csv")
```

Data dimension is 77 rows by 16 columns

```{r}
dim(cereal)
```

Initial data inspection

```{r}
names(cereal)
```

```{r}
head(cereal, 10)
```

Data structure

```{r}
str(cereal)
```

Data summary

```{r}
summary(cereal)
```

#3. Data cleansing and transformation

Check if data has missing value

```{r}
anyNA(cereal)
```

No missing value from data

```{r echo=false}
cereal_melt <- melt(cereal %>% 
  select(-c(mfr, type)), id.vars="name")

ggplot(cereal_melt) +
  geom_boxplot(aes(y=value))+
  facet_wrap(vars(variable), scale="free_y")+
  labs(title="Boxplot of Each Numeric Columns", y="")
  
```
winsorize
```{r}

```


Transform data type

```{r}
cereal %>% 
  mutate(mfr = as.factor(mfr),
         type = as.factor(type))
         
```

```{r}
unique(cereal$mfr)
unique(cereal$type)
```
Manufacturer(mfr) of cereal:
- A = American Home Food Products;
- G = General Mills
- K = Kelloggs
- N = Nabisco
- P = Post
- Q = Quaker Oats
- R = Ralston Purina

Type of cereal:
- C = Cold
- H = Hot


#4. Further exploratory analysis



Correlation heatmap of numeric columns value
```{r}
cereal_is.numeric <- cereal %>% 
  select_if(is.numeric)

cereal_heatmap <- round(cor(cereal_is.numeric), 1)
cereal_heatmap <- melt(cereal_heatmap)

ggplot(cereal_heatmap, aes(x=X1, y=X2, fill=value)) +
  geom_tile()+
  scale_fill_gradient(low = "pink", high = "dark red")+
  labs(title="Correlation Heatmap",x="", y="")+
  geom_text(aes(x=X1, y=X2, label=value), color="white")+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```


Maybe it is more crucial to look at the correlation specific to the rating column
```{r}
cereal_ratcorr <- data.frame(cor(cereal_is.numeric)) %>% select(rating) %>% filter(rating != 1)
cereal_ratcorr$id <- row.names(cereal_ratcorr)


ggplot(cereal_ratcorr, mapping=aes(x=id, y=rating, fill=rating)) +
  geom_col()+
  ylim(-1,1)+
  scale_fill_gradient2(low = "dark red", mid="white", high = "blue", limits=c(-1,1))+
  labs(title="Correlation with Rating",x="", y="Correlation Value")+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```


Calories and Sugar have a pretty negative correlation with ratings
```{r}

cereal_calcor<- melt(cereal %>% 
select(rating, calories, sugars), id.vars="rating")
  
  
ggplot(cereal_calnSug, mapping=aes(x=rating, y=value)) +
  facet_wrap(vars(variable), scale="free_y")+
  geom_point(aes(col=variable))+
  labs(title="Scatter Plot Correlation of Both Calories and Sugars with Ratings",y="")+
  theme_minimal()
```

Top 5 manufacturer who puts the most sugar in their cereal
```{r}
cereal

aggregate()
```



#5. Conclusion
